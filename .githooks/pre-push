#!/bin/sh

# Define the project subdirectory
PROJECT_DIR="event-scraper"

echo "Running pre-push hook for scraper..."

# Navigate to the project subdirectory
cd "$PROJECT_DIR"

# Run npm build
echo "Running npm build in $PROJECT_DIR..."
npm run build

# Check if npm build succeeded
if [ $? -ne 0 ]; then
  echo "npm run build failed in $PROJECT_DIR. Aborting push."
  exit 1
fi

# Run npm test
echo "Running npm test in $PROJECT_DIR..."
npm run test

# Check if npm test succeeded
if [ $? -ne 0 ]; then
  echo "npm run test failed in $PROJECT_DIR. Aborting push."
  exit 1
fi

echo "Both npm build and test succeeded in $PROJECT_DIR. Proceeding with push."

# Navigate back to the root of the Git repository
cd -

exit 0